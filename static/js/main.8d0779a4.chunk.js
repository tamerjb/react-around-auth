(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,a){e.exports=a.p+"static/media/around.8f7611ae.svg"},21:function(e,t,a){e.exports=a.p+"static/media/successful_icon.e38b395c.svg"},22:function(e,t,a){e.exports=a.p+"static/media/unsuccessful_icon.4072126c.svg"},25:function(e,t,a){e.exports=a(55)},34:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),o=a(15),r=a.n(o),i=(a(34),a(23)),s=a(2),l=a(1),u=a(7),m=a(16),p=a.n(m),d=function(e){var t=e.loggedIn,a=e.email,n=e.handleSignout,o=Object(l.h)();console.log(o);var r="/signin"===o.pathname,i="/signup"===o.pathname;return c.a.createElement("header",{className:"header"},c.a.createElement("div",{className:"header__container"},c.a.createElement("img",{src:p.a,alt:"Around the US Logo",className:"header__logo"}),c.a.createElement("nav",{className:"header_navbar"},c.a.createElement("ul",{className:"header__links ".concat(r||i?"header__links_signup-login-page":"")},r&&c.a.createElement("li",{className:"header__link-item"},c.a.createElement(u.b,{to:"/signup",className:"header__link"},"Sign up")),i&&c.a.createElement("li",{className:"header__link-item"},c.a.createElement(u.b,{to:"/signin",className:"header__link"},"Log in")),t&&c.a.createElement("li",{className:"header__link-item"},c.a.createElement(u.b,{to:"/signin",className:"header__link",onClick:n},"Log out")),t&&c.a.createElement("li",{className:"header__link-item"},a)))))},f=c.a.createContext(),_=function(e){var t=Object(n.useContext)(f),a=e.card.owner._id===t._id,o=e.card.likes.some(function(e){return e._id===t._id}),r="card__like-button ".concat(o&&"card__like-button_active");return c.a.createElement("li",{className:"card"},a&&c.a.createElement("button",{type:"button","aria-label":"delete card",className:"card__image-trash",onClick:function(){e.onDeleteClick(e.card)}}),c.a.createElement("img",{src:e.card.link,alt:e.card.name,className:"card__image",onClick:function(){e.onCardClick(e.card)}}),c.a.createElement("div",{className:"card__info"},c.a.createElement("h2",{className:"card__info-title"},e.card.name),c.a.createElement("div",{className:"card__like-container"},c.a.createElement("button",{className:r,type:"button","aria-label":"like card",onClick:function(){e.onLikeCard(e.card)}}),c.a.createElement("span",{className:"card__like-count"},e.card.likes.length))))},h=function(e){e.props;var t=e.onCardLike,a=e.cards,o=e.onEditProfileClick,r=e.onEditAvatarClick,i=e.onAddPlaceClick,s=e.onCardClick,l=e.onDeleteClick,u=Object(n.useContext)(f);return c.a.createElement("main",{className:"content"},c.a.createElement("section",{className:"profile"},c.a.createElement("div",{onClick:r,className:"profile__image-container"},c.a.createElement("img",{src:u.avatar,alt:"Profile Picture",className:"profile__image"})),c.a.createElement("div",{className:"profile__info"},c.a.createElement("div",{className:"profile__person"},c.a.createElement("h1",{className:"profile__name"},u.name),c.a.createElement("button",{onClick:o,className:"profile__edit-button",type:"button"})),c.a.createElement("p",{className:"profile__title"},u.about)),c.a.createElement("button",{onClick:i,className:"profile__add-button",type:"button"})),c.a.createElement("section",{className:"cards"},c.a.createElement("ul",{className:"cards__list"},a.map(function(e){return c.a.createElement(_,{card:e,key:e._id,onCardClick:s,onDeleteClick:l,onLikeCard:t})}))))},b=function(){return c.a.createElement("footer",{className:"footer"},c.a.createElement("p",{className:"footer__copyrights"},"\xa9 ",(new Date).getFullYear()," Around The U.S."))},E=function(e){return c.a.createElement("div",{className:"popup-prev popup ".concat(e.isOpen?"popup_opened":"")},c.a.createElement("div",{className:"popup__preview-container"},c.a.createElement("button",{className:"popup__close-button",onClick:e.onClose,type:"button"}),c.a.createElement("img",{src:e.card.link,alt:e.card.name,className:"popup__image"}),c.a.createElement("p",{className:"popup__caption"},e.card.name)))},g=function(e){return c.a.createElement("div",{className:"popup ".concat(e.name," ").concat(e.isOpen?"popup_opened":"")},c.a.createElement("div",{className:"popup__container"},c.a.createElement("button",{className:"popup__close-button",type:"button",onClick:e.onClose}),c.a.createElement("h2",{className:"popup__title"},e.title),c.a.createElement("form",{action:"submit",onSubmit:e.onSubmit,className:"form popup__form",name:e.name},e.children,c.a.createElement("fieldset",{className:"form__fieldset"},c.a.createElement("button",{className:"form__button",type:"submit"},e.buttonText)))))},v=function(e){var t=e.isLoading,a=e.isOpen,o=e.onClose,r=e.onUpdateUser,i=Object(n.useContext)(f),l=Object(n.useState)(""),u=Object(s.a)(l,2),m=u[0],p=u[1],d=Object(n.useState)(""),_=Object(s.a)(d,2),h=_[0],b=_[1];Object(n.useEffect)(function(){p(i.name||""),b(i.about||"")},[i]);return c.a.createElement(g,{title:"Edit profile",name:"popup-edit-profile",isOpen:a,onClose:o,onSubmit:function(e){e.preventDefault(),r({name:m,about:h})},buttonText:t?"Saving...":"Save"},c.a.createElement("fieldset",{className:"form__fieldset"},c.a.createElement("div",{className:"form__input-container"},c.a.createElement("input",{id:"name-input",type:"text",name:"name",value:m,placeholder:"Name",className:"form__input form__input_type_profile-name",minLength:"2",maxLength:"40",onChange:function(e){p(e.target.value)},required:!0}),c.a.createElement("span",{className:"form__input-error name-input-error"})),c.a.createElement("div",{className:"form__input-container"},c.a.createElement("input",{id:"title-input",type:"text",name:"title",placeholder:"About me",className:"form__input form__input_type_profile-title",minLength:"2",maxLength:"200",onChange:function(e){b(e.target.value)},required:!0,value:h}),c.a.createElement("span",{className:"form__input-error title-input-error"}))))},N=function(e){var t=e.isLoading,a=e.isOpen,o=e.onClose,r=e.onUpdateAvatar,i=Object(n.useRef)();return c.a.createElement(g,{title:"Change Profile Picture",name:"popup_type_avatar",isOpen:a,onClose:o,buttonText:t?"Saving...":"Save",onSubmit:function(e){e.preventDefault(),r(i.current.value)}},c.a.createElement("fieldset",{className:"form__fieldset"},c.a.createElement("div",{className:"form__input-container"},c.a.createElement("input",{id:"avatar-input",type:"url",name:"link",placeholder:"Profile Image link",className:"form__input form__input_type_avatar",required:!0,ref:i}),c.a.createElement("span",{className:"form__input-error avatar-input-error"}))))},k=function(e){var t=e.isLoading,a=e.isOpen,o=e.onClose,r=e.onAddPlaceSubmit,i=Object(n.useState)(""),l=Object(s.a)(i,2),u=l[0],m=l[1],p=Object(n.useState)(""),d=Object(s.a)(p,2),f=d[0],_=d[1];return Object(n.useEffect)(function(){a&&(m(""),_(""))},[a]),c.a.createElement(g,{title:"New place",name:"popup-place",isOpen:a,onClose:o,buttonText:t?"Saving...":"Create",onSubmit:function(e){e.preventDefault(),r({name:u,link:f})}},c.a.createElement("fieldset",{className:"form__fieldset"},c.a.createElement("div",{className:"form__input-container"},c.a.createElement("input",{id:"place-title-input",type:"text",name:"name",placeholder:"Title",className:"form__input form__input_type_place-name",required:!0,minLength:"1",maxLength:"30",onChange:function(e){m(e.target.value)},value:u}),c.a.createElement("span",{className:"form__input-error place-title-input-error"})),c.a.createElement("div",{className:"form__input-container"},c.a.createElement("input",{id:"place-url-input",type:"url",name:"link",placeholder:"Image link",className:"form__input form__input_type_place-url",required:!0,onChange:function(e){_(e.target.value)},value:f}),c.a.createElement("span",{className:"form__input-error place-url-input-error"}))))},O=function(e){var t=e.isLoading,a=e.isOpen,n=e.onClose,o=e.onSubmitDelete;return c.a.createElement(g,{title:"Are you sure?",name:"delete-card",buttonText:t?"Deleting...":"Yes",isOpen:a,onClose:n,onSubmit:o})},C=a(19),j=a(20),y=new(function(){function e(t){var a=t.baseUrl,n=t.headers;Object(C.a)(this,e),this._baseUrl=a,this._headers=n}return Object(j.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Error ".concat(e.status))}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._checkResponse)}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._checkResponse)}},{key:"setUserInfo",value:function(e){var t=e.name,a=e.about;return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,about:a})}).then(this._checkResponse)}},{key:"createCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify(e)}).then(this._checkResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"}).then(this._checkResponse)}},{key:"changeLikeCardStatus",value:function(e,t){return t?fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"PUT"}).then(this._checkResponse):fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"DELETE"}).then(this._checkResponse)}},{key:"setUserAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then(this._checkResponse)}}]),e}())({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"edde3a5c-b30d-40b0-99e9-6f72ee976ddf","Content-Type":"application/json"}}),S=a(9),L=a(11),w=function(e){var t=e.handleLogin,a=e.isLoading,o=Object(n.useState)({email:"",password:""}),r=Object(s.a)(o,2),i=r[0],l=r[1],m=function(e){var t=e.target,a=t.name,n=t.value;l(Object(L.a)({},i,Object(S.a)({},a,n)))};return c.a.createElement("div",{className:"auth-form"},c.a.createElement("h2",{className:"auth-form__title"},"Log in"),c.a.createElement("form",{className:"auth-form__form",onSubmit:function(e){e.preventDefault();var a=i.email,n=i.password;t({email:a,password:n})}},c.a.createElement("input",{type:"email",name:"email",className:"auth-form__input",placeholder:"Email",value:i.email,onChange:m}),c.a.createElement("input",{type:"password",name:"password",className:"auth-form__input",placeholder:"Password",value:i.password,onChange:m}),c.a.createElement("div",{className:"auth-form__footer"},c.a.createElement("div",{className:"auth-form__footer-wrapper"},c.a.createElement("button",{type:"submit",className:"auth-form__submit-button"},a?"Logging In...":"Log in"),c.a.createElement("p",{className:"auth-form__footer-text"},"Not a member yet?"," ",c.a.createElement(u.b,{to:"/signup",className:"auth-form__footer-link"},"Sign up here!"))))))},T=function(e){var t=e.handleRegister,a=Object(n.useState)({email:"",password:""}),o=Object(s.a)(a,2),r=o[0],i=o[1],l=function(e){var t=e.target,a=t.name,n=t.value;i(Object(L.a)({},r,Object(S.a)({},a,n)))};return c.a.createElement("div",{className:"auth-form"},c.a.createElement("h2",{className:"auth-form__title"},"Sign up"),c.a.createElement("form",{className:"auth-form__form",onSubmit:function(e){e.preventDefault();var a=r.email,n=r.password;t({email:a,password:n})}},c.a.createElement("input",{type:"email",name:"email",className:"auth-form__input",placeholder:"Email",value:r.email,onChange:l}),c.a.createElement("input",{type:"password",name:"password",className:"auth-form__input",placeholder:"Password",value:r.password,onChange:l}),c.a.createElement("div",{className:"auth-form__footer"},c.a.createElement("div",{className:"auth-form__footer-wrapper"},c.a.createElement("button",{type:"submit",className:"auth-form__submit-button"},"Sign up"),c.a.createElement("p",{className:"auth-form__footer-text"},"Already a member?"," ",c.a.createElement(u.b,{to:"/signin",className:"auth-form__footer-link"},"Log in here!"))))))},U=a(24),P=function(e){var t=e.loggedIn,a=e.children,n=Object(U.a)(e,["loggedIn","children"]);return t?c.a.createElement(l.b,n,a):c.a.createElement(l.a,{to:"/signin"})},x=a(21),A=a.n(x),I=a(22),D=a.n(I),R=function(e){var t=e.isOpen,a=e.name,o=e.onClose,r=e.children;return Object(n.useEffect)(function(){if(t)return document.addEventListener("keydown",e),document.addEventListener("click",a),function(){document.removeEventListener("keydown",e),document.removeEventListener("click",a)};function e(e){"Escape"===e.key&&o()}function a(e){e.target.classList.contains("popup_opened")&&o()}},[t,o]),c.a.createElement("div",{className:"popup ".concat(t?"popup_opened":""," popup_type_").concat(a)},c.a.createElement("div",{className:"popup__container popup__container_type_".concat(a)},r,c.a.createElement("button",{className:"popup__close-button ".concat("popup__close-button_type_".concat(a)),type:"button",onClick:o})))},J=function(e){var t=e.isOpen,a=e.onClose,o="successful"===e.type;return Object(n.useEffect)(function(){if(t){var e=setTimeout(function(){a()},3500);return function(){return clearTimeout(e)}}},[t]),c.a.createElement(R,{isOpen:t,name:"tooltip",onClose:a},c.a.createElement("img",{src:o?A.a:D.a,className:"tooltip__image",alt:"".concat(o?"successful":"unsuccessful"," attempt")}),c.a.createElement("h2",{className:"tooltip__text"},o?"Success! You have now been registered.":"Oops, something went wrong! Please try again."))},q="https://register.nomoreparties.co",F=function(e,t){return fetch(e,t).then(function(e){return e.ok?e.json():Promise.reject(e.statusText)})},B=function(e,t){return F("".concat(q,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})})},Y=function(e,t){return F("".concat(q,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})})},z=function(e){return F("".concat(q,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}})};var H=function(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],o=t[1],r=Object(n.useState)(!1),u=Object(s.a)(r,2),m=u[0],p=u[1],_=Object(n.useState)(!1),g=Object(s.a)(_,2),C=g[0],j=g[1],S=Object(n.useState)(!1),L=Object(s.a)(S,2),U=L[0],x=L[1],A=Object(n.useState)(!1),I=Object(s.a)(A,2),D=I[0],R=I[1],q=Object(n.useState)(!1),F=Object(s.a)(q,2),H=F[0],G=F[1],M=Object(n.useState)({name:"",link:""}),K=Object(s.a)(M,2),Q=K[0],V=K[1],W=Object(n.useState)([]),X=Object(s.a)(W,2),Z=X[0],$=X[1],ee=Object(n.useState)({}),te=Object(s.a)(ee,2),ae=te[0],ne=te[1],ce=Object(n.useState)(!1),oe=Object(s.a)(ce,2),re=oe[0],ie=oe[1],se=Object(n.useState)(""),le=Object(s.a)(se,2),ue=le[0],me=le[1],pe=function(){o(!1),p(!1),j(!1),x(!1),R(!1),G(!1)},de=Object(n.useState)(!1),fe=Object(s.a)(de,2),_e=fe[0],he=fe[1],be=Object(n.useState)({email:"email@mail.com"}),Ee=Object(s.a)(be,2),ge=Ee[0],ve=Ee[1],Ne=Object(n.useState)(!0),ke=Object(s.a)(Ne,2),Oe=ke[0],Ce=ke[1],je=Object(l.g)();return Object(n.useEffect)(function(){y.getInitialCards().then(function(e){$(e)}).catch(console.log)},[]),Object(n.useEffect)(function(){y.getUserInfo().then(function(e){ne(e)}).catch(console.log)},[]),Object(n.useEffect)(function(){var e=function(e){"Escape"===e.key&&pe()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}},[]),Object(n.useEffect)(function(){var e=function(e){e.target.classList.contains("popup")&&pe()};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}},[]),Object(n.useEffect)(function(){var e=localStorage.getItem("jwt");e?z(e).then(function(e){e.data._id&&(he(!0),ve({email:e.data.email}),je.push("/react-around-auth"))}).catch(function(e){console.log(e),je.push("/signin")}).finally(function(){Ce(!1)}):Ce(!1)},[]),c.a.createElement("div",{className:"body"},c.a.createElement(f.Provider,{value:ae},c.a.createElement(d,{loggedIn:_e,email:ge.email,handleSignout:function(){he(!1),localStorage.removeItem("jwt"),je.push("/signin")}}),c.a.createElement(l.d,null,c.a.createElement(P,{exact:!0,path:"/react-around-auth",loggedIn:_e,isCheckingToken:Oe},c.a.createElement(h,{onEditProfileClick:function(){p(!0)},onAddPlaceClick:function(){j(!0)},onEditAvatarClick:function(){o(!0)},onCardClick:function(e){x(!0),V({name:e.name,link:e.link})},onDeleteClick:function(e){R(!0),V(e)},onCardLike:function(e){var t=e.likes.some(function(e){return e._id===ae._id});y.changeLikeCardStatus(e._id,!t).then(function(t){$(function(a){return a.map(function(a){return a._id===e._id?t:a})})}).catch(console.log)},cards:Z})),c.a.createElement(l.b,{path:"/signup"},c.a.createElement(T,{handleRegister:function(e){var t=e.email,a=e.password;ie(!0),B(t,a).then(function(e){e.data._id?(me("successful"),je.push("/signin")):me("unsuccessful")}).catch(function(e){console.log(e),me("unsuccessful")}).finally(function(){G(!0),ie(!1)})}})),c.a.createElement(l.b,{path:"/signin"},c.a.createElement(w,{handleLogin:function(e){var t=e.email,a=e.password;ie(!0),Y(t,a).then(function(e){e.token&&(he(!0),ve({email:t}),localStorage.setItem("jwt",e.token),je.push("/react-around-auth"))}).catch(function(e){console.log(e),me("unsuccessful"),G(!0)}).finally(function(){Ce(!1),ie(!1)})},isLoading:re})),c.a.createElement(l.b,null,_e?c.a.createElement(l.a,{to:"/react-around-auth"}):c.a.createElement(l.a,{to:"/signin"}))),c.a.createElement(b,null),c.a.createElement(v,{isOpen:m,onClose:pe,onUpdateUser:function(e){var t=e.name,a=e.about;ie(!0),y.setUserInfo({name:t,about:a}).then(function(e){ne(e),pe()}).catch(console.log).finally(function(){ie(!1)})},isLoading:re}),c.a.createElement(k,{isLoading:re,isOpen:C,onClose:pe,onAddPlaceSubmit:function(e){ie(!0),y.createCard(e).then(function(e){$([e].concat(Object(i.a)(Z))),pe()}).catch(console.log).finally(function(){ie(!1)})}}),c.a.createElement(N,{isOpen:a,onClose:pe,onUpdateAvatar:function(e){ie(!0),y.setUserAvatar(e).then(function(e){ne(e),pe()}).catch(console.log).finally(function(){ie(!1)})},isLoading:re}),c.a.createElement(O,{isLoading:re,isOpen:D,onClose:pe,onSubmitDelete:function(e){e.preventDefault(),ie(!0),y.deleteCard(Q._id).then(function(e){var t=Z.filter(function(e){return e._id!==Q._id});$(t),pe()}).catch(console.log).finally(function(){ie(!1)})}}),c.a.createElement(E,{card:Q,isOpen:U,onClose:pe}),c.a.createElement(J,{isOpen:H,onClose:pe,type:ue,isTooltipOpen:H,name:"tooltip"})))},G=function(e){e&&e instanceof Function&&a.e(1).then(a.bind(null,56)).then(function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,o=t.getLCP,r=t.getTTFB;a(e),n(e),c(e),o(e),r(e)})};r.a.createRoot(document.getElementById("root")).render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(u.a,null,c.a.createElement(H,null)))),G()}},[[25,3,2]]]);
//# sourceMappingURL=main.8d0779a4.chunk.js.map