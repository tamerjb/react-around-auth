(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,a){e.exports=a.p+"static/media/around.8f7611ae.svg"},21:function(e,t,a){e.exports=a.p+"static/media/successful_icon.e38b395c.svg"},22:function(e,t,a){e.exports=a.p+"static/media/unsuccessful_icon.4072126c.svg"},25:function(e,t,a){e.exports=a(55)},34:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),o=a(15),r=a.n(o),i=(a(34),a(23)),s=a(2),l=a(1),u=a(7),m=a(16),p=a.n(m),d=function(e){var t=e.loggedIn,a=e.email,n=e.handleSignout,o=Object(l.h)(),r="/signin"===o.pathname,i="/signup"===o.pathname;return c.a.createElement("header",{className:"header"},c.a.createElement("div",{className:"header__container"},c.a.createElement("img",{src:p.a,alt:"Around the US Logo",className:"header__logo"}),c.a.createElement("nav",{className:"header_navbar"},c.a.createElement("ul",{className:"header__links ".concat(r||i?"header__links_signup-login-page":"")},r&&c.a.createElement("li",{className:"header__link-item"},c.a.createElement(u.b,{to:"/signup",className:"header__link"},"Sign up")),i&&c.a.createElement("li",{className:"header__link-item"},c.a.createElement(u.b,{to:"/signin",className:"header__link"},"Log in")),t&&c.a.createElement("li",{className:"header__link-item"},c.a.createElement(u.b,{to:"/signin",className:"header__link",onClick:n},"Log out")),t&&c.a.createElement("li",{className:"header__link-item"},a)))))},f=c.a.createContext(),_=function(e){var t=Object(n.useContext)(f),a=e.card.owner._id===t._id,o=e.card.likes.some(function(e){return e._id===t._id}),r="card__like-button ".concat(o&&"card__like-button_active");return c.a.createElement("li",{className:"card"},a&&c.a.createElement("button",{type:"button","aria-label":"delete card",className:"card__image-trash",onClick:function(){e.onDeleteClick(e.card)}}),c.a.createElement("img",{src:e.card.link,alt:e.card.name,className:"card__image",onClick:function(){e.onCardClick(e.card)}}),c.a.createElement("div",{className:"card__info"},c.a.createElement("h2",{className:"card__info-title"},e.card.name),c.a.createElement("div",{className:"card__like-container"},c.a.createElement("button",{className:r,type:"button","aria-label":"like card",onClick:function(){e.onLikeCard(e.card)}}),c.a.createElement("span",{className:"card__like-count"},e.card.likes.length))))},h=function(e){var t=e.onCardLike,a=e.cards,o=e.onEditProfileClick,r=e.onEditAvatarClick,i=e.onAddPlaceClick,s=e.onCardClick,l=e.onDeleteClick,u=Object(n.useContext)(f);return c.a.createElement("main",{className:"content"},c.a.createElement("section",{className:"profile"},c.a.createElement("div",{onClick:r,className:"profile__image-container"},c.a.createElement("img",{src:u.avatar,alt:"Profile Picture",className:"profile__image"})),c.a.createElement("div",{className:"profile__info"},c.a.createElement("div",{className:"profile__person"},c.a.createElement("h1",{className:"profile__name"},u.name),c.a.createElement("button",{onClick:o,className:"profile__edit-button",type:"button"})),c.a.createElement("p",{className:"profile__title"},u.about)),c.a.createElement("button",{onClick:i,className:"profile__add-button",type:"button"})),c.a.createElement("section",{className:"cards"},c.a.createElement("ul",{className:"cards__list"},a.map(function(e){return c.a.createElement(_,{card:e,key:e._id,onCardClick:s,onDeleteClick:l,onLikeCard:t})}))))},b=function(){return c.a.createElement("footer",{className:"footer"},c.a.createElement("p",{className:"footer__copyrights"},"\xa9 ",(new Date).getFullYear()," Around The U.S."))},E=function(e){var t=e.isOpen,a=e.name,o=e.onClose,r=e.children;return Object(n.useEffect)(function(){if(t)return document.addEventListener("keydown",e),document.addEventListener("click",a),function(){document.removeEventListener("keydown",e),document.removeEventListener("click",a)};function e(e){"Escape"===e.key&&o()}function a(){t||o()}},[t,o]),c.a.createElement("div",{onClick:o},c.a.createElement("div",{className:"popup ".concat(t?"popup_opened":""," ")},c.a.createElement("div",{className:"popup__container ".concat(a," "),onClick:function(e){e.stopPropagation()}},r,c.a.createElement("button",{className:"popup__close-button ".concat("popup__close-button_type_".concat(a)),type:"button",onClick:o}))))},g=function(e){return c.a.createElement(E,{isOpen:e.isOpen,name:e.name,onClose:e.onClose},c.a.createElement("p",{className:"popup__caption"},e.card.name),c.a.createElement("img",{src:e.card.link,alt:"A beautiful scene in ".concat(e.card.name),className:"popup__image"}))},v=function(e){return c.a.createElement(E,{isOpen:e.isOpen,name:e.name,onClose:e.onClose},c.a.createElement("h2",{className:"popup__title popup__title_type_".concat(e.name)},e.title),c.a.createElement("form",{action:"submit",className:"form popup__form",name:e.name,onSubmit:e.onSubmit},e.children,c.a.createElement("fieldset",{className:"form__fieldset"},c.a.createElement("button",{className:"form__button form__button_type_".concat(e.name),type:"submit"},e.buttonText))))},O=function(e){var t=e.isLoading,a=e.isOpen,o=e.onClose,r=e.onUpdateUser,i=Object(n.useContext)(f),l=Object(n.useState)(""),u=Object(s.a)(l,2),m=u[0],p=u[1],d=Object(n.useState)(""),_=Object(s.a)(d,2),h=_[0],b=_[1];Object(n.useEffect)(function(){p(i.name||""),b(i.about||"")},[i]);return c.a.createElement(v,{title:"Edit profile",name:"popup-edit-profile",isOpen:a,onClose:o,onSubmit:function(e){e.preventDefault(),r({name:m,about:h})},buttonText:t?"Saving...":"Save"},c.a.createElement("fieldset",{className:"form__fieldset"},c.a.createElement("div",{className:"form__input-container"},c.a.createElement("input",{id:"name-input",type:"text",name:"name",value:m,placeholder:"Name",className:"form__input form__input_type_profile-name",minLength:"2",maxLength:"40",onChange:function(e){p(e.target.value)},required:!0}),c.a.createElement("span",{className:"form__input-error name-input-error"})),c.a.createElement("div",{className:"form__input-container"},c.a.createElement("input",{id:"title-input",type:"text",name:"title",placeholder:"About me",className:"form__input form__input_type_profile-title",minLength:"2",maxLength:"200",onChange:function(e){b(e.target.value)},required:!0,value:h}),c.a.createElement("span",{className:"form__input-error title-input-error"}))))},k=function(e){var t=e.isLoading,a=e.isOpen,o=e.onClose,r=e.onUpdateAvatar,i=Object(n.useRef)();return c.a.createElement(v,{title:"Change Profile Picture",name:"popup_type_avatar",isOpen:a,onClose:o,buttonText:t?"Saving...":"Save",onSubmit:function(e){e.preventDefault(),r(i.current.value)}},c.a.createElement("fieldset",{className:"form__fieldset"},c.a.createElement("div",{className:"form__input-container"},c.a.createElement("input",{id:"avatar-input",type:"url",name:"link",placeholder:"Profile Image link",className:"form__input form__input_type_avatar",required:!0,ref:i}),c.a.createElement("span",{className:"form__input-error avatar-input-error"}))))},N=function(e){var t=e.isLoading,a=e.isOpen,o=e.onClose,r=e.onAddPlaceSubmit,i=Object(n.useState)(""),l=Object(s.a)(i,2),u=l[0],m=l[1],p=Object(n.useState)(""),d=Object(s.a)(p,2),f=d[0],_=d[1];return Object(n.useEffect)(function(){a&&(m(""),_(""))},[a]),c.a.createElement(v,{title:"New place",name:"popup-place",isOpen:a,onClose:o,buttonText:t?"Saving...":"Create",onSubmit:function(e){e.preventDefault(),r({name:u,link:f})}},c.a.createElement("fieldset",{className:"form__fieldset"},c.a.createElement("div",{className:"form__input-container"},c.a.createElement("input",{id:"place-title-input",type:"text",name:"name",placeholder:"Title",className:"form__input form__input_type_place-name",required:!0,minLength:"1",maxLength:"30",onChange:function(e){m(e.target.value)},value:u}),c.a.createElement("span",{className:"form__input-error place-title-input-error"})),c.a.createElement("div",{className:"form__input-container"},c.a.createElement("input",{id:"place-url-input",type:"url",name:"link",placeholder:"Image link",className:"form__input form__input_type_place-url",required:!0,onChange:function(e){_(e.target.value)},value:f}),c.a.createElement("span",{className:"form__input-error place-url-input-error"}))))},C=function(e){var t=e.isLoading,a=e.isOpen,n=e.onClose,o=e.onSubmitDelete;return c.a.createElement(v,{title:"Are you sure?",name:"delete-card",buttonText:t?"Deleting...":"Yes",isOpen:a,onClose:n,onSubmit:o})},j=a(19),y=a(20),S=new(function(){function e(t){var a=t.baseUrl,n=t.headers;Object(j.a)(this,e),this._baseUrl=a,this._headers=n}return Object(y.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Error ".concat(e.status))}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._checkResponse)}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._checkResponse)}},{key:"setUserInfo",value:function(e){var t=e.name,a=e.about;return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,about:a})}).then(this._checkResponse)}},{key:"createCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify(e)}).then(this._checkResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"}).then(this._checkResponse)}},{key:"changeLikeCardStatus",value:function(e,t){return t?fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"PUT"}).then(this._checkResponse):fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"DELETE"}).then(this._checkResponse)}},{key:"setUserAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then(this._checkResponse)}}]),e}())({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"edde3a5c-b30d-40b0-99e9-6f72ee976ddf","Content-Type":"application/json"}}),w=a(9),L=a(11),T=function(e){var t=e.handleLogin,a=e.isLoading,o=Object(n.useState)({email:"",password:""}),r=Object(s.a)(o,2),i=r[0],l=r[1],m=function(e){var t=e.target,a=t.name,n=t.value;l(Object(L.a)({},i,Object(w.a)({},a,n)))};return c.a.createElement("div",{className:"auth-form"},c.a.createElement("h2",{className:"auth-form__title"},"Log in"),c.a.createElement("form",{className:"auth-form__form",onSubmit:function(e){e.preventDefault();var a=i.email,n=i.password;t({email:a,password:n})}},c.a.createElement("input",{type:"email",name:"email",className:"auth-form__input",placeholder:"Email",value:i.email,onChange:m}),c.a.createElement("input",{type:"password",name:"password",className:"auth-form__input",placeholder:"Password",value:i.password,onChange:m}),c.a.createElement("div",{className:"auth-form__footer"},c.a.createElement("div",{className:"auth-form__footer-wrapper"},c.a.createElement("button",{type:"submit",className:"auth-form__submit-button"},a?"Logging In...":"Log in"),c.a.createElement("p",{className:"auth-form__footer-text"},"Not a member yet?"," ",c.a.createElement(u.b,{to:"/signup",className:"auth-form__footer-link"},"Sign up here!"))))))},P=function(e){var t=e.handleRegister,a=Object(n.useState)({email:"",password:""}),o=Object(s.a)(a,2),r=o[0],i=o[1],l=function(e){var t=e.target,a=t.name,n=t.value;i(Object(L.a)({},r,Object(w.a)({},a,n)))};return c.a.createElement("div",{className:"auth-form"},c.a.createElement("h2",{className:"auth-form__title"},"Sign up"),c.a.createElement("form",{className:"auth-form__form",onSubmit:function(e){e.preventDefault();var a=r.email,n=r.password;t({email:a,password:n})}},c.a.createElement("input",{type:"email",name:"email",className:"auth-form__input",placeholder:"Email",value:r.email,onChange:l}),c.a.createElement("input",{type:"password",name:"password",className:"auth-form__input",placeholder:"Password",value:r.password,onChange:l}),c.a.createElement("div",{className:"auth-form__footer"},c.a.createElement("div",{className:"auth-form__footer-wrapper"},c.a.createElement("button",{type:"submit",className:"auth-form__submit-button"},"Sign up"),c.a.createElement("p",{className:"auth-form__footer-text"},"Already a member?"," ",c.a.createElement(u.b,{to:"/signin",className:"auth-form__footer-link"},"Log in here!"))))))},U=a(24),x=function(e){var t=e.loggedIn,a=e.children,n=Object(U.a)(e,["loggedIn","children"]);return t?c.a.createElement(l.b,n,a):c.a.createElement(l.a,{to:"/signin"})},A=a(21),I=a.n(A),D=a(22),R=a.n(D),J=function(e){var t=e.isOpen,a=e.onClose,o="successful"===e.type;return Object(n.useEffect)(function(){if(t){var e=setTimeout(function(){a()},3500);return function(){return clearTimeout(e)}}},[t]),c.a.createElement(E,{isOpen:t,name:"tooltip",onClose:a},c.a.createElement("img",{src:o?I.a:R.a,className:"tooltip__image",alt:"".concat(o?"successful":"unsuccessful"," attempt")}),c.a.createElement("h2",{className:"tooltip__text"},o?"Success! You have now been registered.":"Oops, something went wrong! Please try again."))},q="https://register.nomoreparties.co",F=function(e,t){return fetch(e,t).then(function(e){return e.ok?e.json():Promise.reject(e.statusText)})},B=function(e,t){return F("".concat(q,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})})},Y=function(e,t){return F("".concat(q,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})})},z=function(e){return F("".concat(q,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}})};var H=function(){var e=Object(l.g)(),t=Object(n.useState)(!1),a=Object(s.a)(t,2),o=a[0],r=a[1],u=Object(n.useState)(!1),m=Object(s.a)(u,2),p=m[0],_=m[1],E=Object(n.useState)(!1),v=Object(s.a)(E,2),j=v[0],y=v[1],w=Object(n.useState)(!1),L=Object(s.a)(w,2),U=L[0],A=L[1],I=Object(n.useState)(!1),D=Object(s.a)(I,2),R=D[0],q=D[1],F=Object(n.useState)(!1),H=Object(s.a)(F,2),G=H[0],M=H[1],K=Object(n.useState)({name:"",link:""}),Q=Object(s.a)(K,2),V=Q[0],W=Q[1],X=Object(n.useState)([]),Z=Object(s.a)(X,2),$=Z[0],ee=Z[1],te=Object(n.useState)({}),ae=Object(s.a)(te,2),ne=ae[0],ce=ae[1],oe=Object(n.useState)(!1),re=Object(s.a)(oe,2),ie=re[0],se=re[1],le=Object(n.useState)(""),ue=Object(s.a)(le,2),me=ue[0],pe=ue[1],de=Object(n.useState)(!1),fe=Object(s.a)(de,2),_e=fe[0],he=fe[1],be=Object(n.useState)({email:"email@mail.com"}),Ee=Object(s.a)(be,2),ge=Ee[0],ve=Ee[1],Oe=Object(n.useState)(!0),ke=Object(s.a)(Oe,2),Ne=ke[0],Ce=ke[1];Object(n.useEffect)(function(){S.getInitialCards().then(function(e){ee(e)}).catch(console.log)},[]),Object(n.useEffect)(function(){S.getUserInfo().then(function(e){ce(e)}).catch(console.log)},[]),Object(n.useEffect)(function(){var t=localStorage.getItem("jwt");t?z(t).then(function(t){t.data._id&&(he(!0),ve({email:t.data.email}),e.push("/react-around-auth"))}).catch(function(t){console.log(t),e.push("/signin")}).finally(function(){Ce(!1)}):Ce(!1)},[]);var je=function(){r(!1),_(!1),y(!1),A(!1),q(!1),M(!1)};return c.a.createElement("div",{className:"body"},c.a.createElement(f.Provider,{value:ne},c.a.createElement(d,{loggedIn:_e,email:ge.email,handleSignout:function(){he(!1),localStorage.removeItem("jwt"),e.push("/signin")}}),c.a.createElement(l.d,null,c.a.createElement(x,{exact:!0,path:"/react-around-auth",loggedIn:_e,isCheckingToken:Ne},c.a.createElement(h,{onEditProfileClick:function(){_(!p)},onAddPlaceClick:function(){y(!j)},onEditAvatarClick:function(){r(!o)},onCardClick:function(e){A(!0),W({name:e.name,link:e.link})},onDeleteClick:function(e){q(!0),W(e)},onCardLike:function(e){var t=e.likes.some(function(e){return e._id===ne._id});S.changeLikeCardStatus(e._id,!t).then(function(t){ee(function(a){return a.map(function(a){return a._id===e._id?t:a})})}).catch(console.log)},cards:$})),c.a.createElement(l.b,{path:"/signup"},c.a.createElement(P,{handleRegister:function(t){var a=t.email,n=t.password;se(!0),B(a,n).then(function(t){t.data._id?(pe("successful"),e.push("/signin")):pe("unsuccessful")}).catch(function(e){console.log(e),pe("unsuccessful")}).finally(function(){M(!0),se(!1)})}})),c.a.createElement(l.b,{path:"/signin"},c.a.createElement(T,{handleLogin:function(t){var a=t.email,n=t.password;se(!0),Y(a,n).then(function(t){t.token&&(he(!0),ve({email:a}),localStorage.setItem("jwt",t.token),e.push("/react-around-auth"))}).catch(function(e){console.log(e),pe("unsuccessful"),M(!0)}).finally(function(){Ce(!1),se(!1)})},isLoading:ie})),c.a.createElement(l.b,null,_e?c.a.createElement(l.a,{to:"/react-around-auth"}):c.a.createElement(l.a,{to:"/signin"}))),c.a.createElement(b,null),c.a.createElement(O,{isOpen:p,onClose:je,onUpdateUser:function(e){var t=e.name,a=e.about;se(!0),S.setUserInfo({name:t,about:a}).then(function(e){ce(e),je()}).catch(console.log).finally(function(){se(!1)})},isLoading:ie,name:"avatar"}),c.a.createElement(N,{isLoading:ie,isOpen:j,onClose:je,onAddPlaceSubmit:function(e){se(!0),S.createCard(e).then(function(e){ee([e].concat(Object(i.a)($))),je()}).catch(console.log).finally(function(){se(!1)})},closeOverlay:je}),c.a.createElement(k,{isOpen:o,onClose:je,onUpdateAvatar:function(e){se(!0),S.setUserAvatar(e).then(function(e){ce(e),je()}).catch(console.log).finally(function(){se(!1)})},isLoading:ie}),c.a.createElement(C,{isLoading:ie,isOpen:R,onClose:je,onSubmitDelete:function(e){e.preventDefault(),se(!0),S.deleteCard(V._id).then(function(e){var t=$.filter(function(e){return e._id!==V._id});ee(t),je()}).catch(console.log).finally(function(){se(!1)})}}),c.a.createElement(g,{card:V,isOpen:U,onClose:je,name:"popup__preview-container"}),c.a.createElement(J,{isOpen:G,onClose:je,type:me,isTooltipOpen:G,name:"tooltip"})))},G=function(e){e&&e instanceof Function&&a.e(1).then(a.bind(null,56)).then(function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,o=t.getLCP,r=t.getTTFB;a(e),n(e),c(e),o(e),r(e)})};r.a.createRoot(document.getElementById("root")).render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(u.a,null,c.a.createElement(H,null)))),G()}},[[25,3,2]]]);
//# sourceMappingURL=main.f2897582.chunk.js.map